(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(21),r=n.n(s),i=n(9),o=(n(29),n(23)),u=n(2),l=n(3),p=n(4),j=c.a.createContext(),d=n.p+"static/media/logo.4e8e0a1d.svg",b=n(0);var h=function(e){var t=e.email,n=e.loggedIn,a=e.onSignOut,c=Object(p.h)();return Object(b.jsxs)("header",{className:"header",children:[Object(b.jsx)("img",{src:d,alt:"Logo",className:"header__logo"}),n?Object(b.jsxs)("ul",{className:"header__menu-items",children:[Object(b.jsx)("li",{className:"header__menu-item header__nav-text_email",children:t}),Object(b.jsx)("li",{className:"header__menu-item header__nav-text",children:Object(b.jsx)("button",{className:"header__nav-text header__nav-text_muted",onClick:a,children:"Log out"})})]}):Object(b.jsx)(i.b,{className:"header__nav-text",to:"/signin"===c.pathname?"/signup":"/signin",children:"/signin"===c.pathname?"Sign up":"Sign in"})]})},m=n(24);var O=function(e){var t=e.component,n=Object(m.a)(e,["component"]);return Object(b.jsx)(p.b,{children:function(){return n.loggedIn?Object(b.jsx)(t,Object(u.a)({},n)):Object(b.jsx)(p.a,{to:"/signin"})}})},_=n.p+"static/media/edit_large_icon.a086f758.svg";var f=function(e){var t=e.card,n=e.onCardDelete,a=e.onCardClick,s=e.onCardLike,r=c.a.useContext(j),i=t.name,o=t.link,u=t.likes,l=t.owner,p=r._id===l,d=u.some((function(e){return e===r._id}));return Object(b.jsxs)("li",{className:"card",children:[Object(b.jsx)("img",{className:"card__image",alt:"Pic: ".concat(i),src:o,onClick:function(){a(t)}}),Object(b.jsxs)("div",{className:"card__text-container",children:[Object(b.jsx)("p",{className:"card__text",children:i}),Object(b.jsxs)("div",{className:"card__likes-container",children:[Object(b.jsx)("button",{className:"button button_like ".concat(d&&"button_like-black"),onClick:function(){s(t)}}),Object(b.jsx)("p",{className:"card__likes-text",children:u.length})]})]}),p&&Object(b.jsx)("button",{className:"button button_delete",onClick:function(){n(t)}})]})};var v=function(e){var t=e.cards,n=e.onCardLike,a=e.onCardDelete,s=e.onCardClick,r=e.onEditProfile,i=e.onEditAvatar,o=e.onAddPlace,u=c.a.useContext(j),l=u.name,p=u.about,d=u.avatar;return Object(b.jsxs)("main",{children:[Object(b.jsxs)("section",{className:"profile",children:[Object(b.jsxs)("div",{className:"profile__avatar-container",children:[Object(b.jsx)("img",{alt:"Avatar Pic",className:"profile__avatar",src:d}),Object(b.jsx)("div",{className:"profile__avatar-edit",onClick:i,children:Object(b.jsx)("img",{src:_,alt:""})})]}),Object(b.jsxs)("div",{className:"profile__text-container",children:[Object(b.jsx)("h1",{className:"profile__name",children:l}),Object(b.jsx)("button",{className:"button button_edit",onClick:r}),Object(b.jsx)("p",{className:"profile__description",children:p})]}),Object(b.jsx)("button",{className:"button button_add",onClick:o})]}),Object(b.jsx)("section",{className:"elements",children:Object(b.jsx)("ul",{className:"cards",children:t.map((function(e){return Object(b.jsx)(f,{card:e,onCardDelete:a,onCardClick:s,onCardLike:n},e._id)}))})})]})};var x=function(){return Object(b.jsx)("footer",{className:"footer",children:Object(b.jsx)("p",{className:"footer__text",children:"\xa9 2020 Around The U.S."})})};var g=function(e){var t=e.card,n=e.onClose,a=e.isOpen,c=t.name,s=t.link;return Object(b.jsx)("div",{className:"popup popup_image ".concat(a&&"popup_is-opened"),children:Object(b.jsxs)("div",{className:"popup__container",children:[Object(b.jsx)("img",{className:"popup__image",alt:c,src:s}),Object(b.jsx)("h2",{className:"popup__image-title",children:c}),Object(b.jsx)("button",{className:"button button_close",onClick:n})]})})};var N=function(e){var t=e.name,n=e.title,a=e.buttonText,c=e.children,s=e.isOpen,r=e.onClose,i=e.onSubmit;return Object(b.jsx)("div",{className:"popup popup_type_".concat(t," ").concat(s&&"popup_is-opened"),children:Object(b.jsxs)("div",{className:"popup__container popup__container_form",children:[Object(b.jsxs)("form",{className:"popup__form",name:t,onSubmit:i,noValidate:!0,children:[Object(b.jsx)("h2",{className:"popup__title",children:n}),c,Object(b.jsx)("button",{type:"submit",className:"button button_save popup__input",children:a})]}),Object(b.jsx)("button",{className:"button button_close",onClick:r})]})})};var k=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,s=c.a.useContext(j),r=c.a.useState(""),i=Object(l.a)(r,2),o=i[0],u=i[1],p=c.a.useState(""),d=Object(l.a)(p,2),h=d[0],m=d[1];return c.a.useEffect((function(){u(s.name),m(s.about)}),[s]),Object(b.jsx)(N,{name:"edit-profile",title:"Edit Profile",buttonText:"Save",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:o,about:h})},children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"text",className:"popup__input popup__input_name",placeholder:"Edit Name",minLength:"2",maxLength:"40",pattern:"[A-Za-z -]+",required:!0,id:"name-input",value:o||"",onChange:function(e){return u(e.target.value)}}),Object(b.jsx)("span",{id:"name-input-error",className:"popup__input-error"})]}),Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"text",className:"popup__input popup__input_desc",placeholder:"Edit Job",minLength:"2",maxLength:"200",required:!0,id:"desc-input",value:h||"",onChange:function(e){return m(e.target.value)}}),Object(b.jsx)("span",{className:"popup__input-error",id:"desc-input-error"})]})]})})};var C=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,s=c.a.useRef();return Object(b.jsx)(N,{name:"edit-avatar",title:"Change Profile Picture",buttonText:"Save",isOpen:t,onClose:n,children:Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"url",className:"popup__input popup__input_avatar",placeholder:"Avatar Link",required:!0,id:"avatar-input",ref:s}),Object(b.jsx)("span",{id:"avatar-input-error",className:"popup__input-error"})]})}),onSubmit:function(e){e.preventDefault(),a({avatar:s.current.value})}})};var S=function(e){var t=e.isOpen,n=e.onClose,a=e.onAddPlace,s=c.a.useRef(),r=c.a.useRef();return Object(b.jsx)(N,{name:"new-place",title:"New Place",buttonText:"Save",isOpen:t,onClose:n,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"text",className:"popup__input popup__input_name",placeholder:"Title",minLength:"1",maxLength:"30",required:!0,id:"title-input",ref:s}),Object(b.jsx)("span",{className:"popup__input-error",id:"title-input-error"})]}),Object(b.jsxs)("label",{className:"popup__field",children:[Object(b.jsx)("input",{type:"url",className:"popup__input popup__input_link",placeholder:"Image Link",required:!0,id:"link-input",ref:r}),Object(b.jsx)("span",{className:"popup__input-error",id:"link-input-error"})]})]}),onSubmit:function(e){e.preventDefault(),a({name:s.current.value,link:r.current.value})}})};var y=function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(l.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(""),u=Object(l.a)(o,2),p=u[0],j=u[1];return Object(b.jsx)("div",{className:"form",children:Object(b.jsxs)("form",{className:"form__container",onSubmit:function(e){e.preventDefault(),t({email:s,password:p})},children:[Object(b.jsx)("h1",{className:"form__title",children:"Log in"}),Object(b.jsx)("input",{className:"form__input",type:"email",value:s,onChange:function(e){return r(e.target.value)},placeholder:"Email"}),Object(b.jsx)("input",{className:"form__input",type:"password",value:p,onChange:function(e){return j(e.target.value)},placeholder:"Password"}),Object(b.jsx)("button",{type:"submit",className:"form__submit",children:"Log in"}),Object(b.jsx)(i.b,{className:"form__link",to:"/signup",children:"Not a member yet? Sign up here!"})]})})};var U=function(e){var t=e.onRegister,n=Object(a.useState)(""),c=Object(l.a)(n,2),s=c[0],r=c[1],o=Object(a.useState)(""),u=Object(l.a)(o,2),p=u[0],j=u[1];return Object(b.jsx)("div",{className:"form",onSubmit:function(e){e.preventDefault(),t({email:s,password:p})},children:Object(b.jsxs)("form",{className:"form__container",children:[Object(b.jsx)("h1",{className:"form__title",children:"Sign up"}),Object(b.jsx)("input",{className:"form__input",type:"email",value:s,placeholder:"Email",onChange:function(e){return r(e.target.value)}}),Object(b.jsx)("input",{className:"form__input",type:"password",placeholder:"Password",value:p,onChange:function(e){return j(e.target.value)}}),Object(b.jsx)("button",{type:"submit",className:"form__submit",children:"Sign up"}),Object(b.jsx)(i.b,{className:"form__link",to:"/signin",children:"Already a member? Log in here!"})]})})},P=n.p+"static/media/success_tooltip.1b6082f8.svg",A=n.p+"static/media/error_tooltip.df8eddf6.svg";var D=function(e){var t,n,a,c=e.isOpen,s=e.onClose;switch(e.type){case"success":t=P,n="Pic: success",a="Success! You have now been registered.";break;default:t=A,n="Pic: error",a="Oops, something went wrong! Please try again."}return Object(b.jsx)("div",{className:"popup ".concat(c&&"popup_is-opened"),children:Object(b.jsxs)("div",{className:"popup__container popup__container_form popup__container_tooltip",children:[Object(b.jsx)("img",{src:t,alt:n}),Object(b.jsx)("p",{className:"popup__text",children:a}),Object(b.jsx)("button",{className:"button button_close",onClick:s})]})})},L=n(14),w=n(15),E=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(L.a)(this,e),this.baseUrl=n,this.headers=a}return Object(w.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getInitialCards",value:function(e){var t=this;return fetch("".concat(this.baseUrl,"/cards"),{headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}).then((function(e){return t._getResponseData(e)}))}},{key:"getUserInfo",value:function(e){var t=this;return fetch("".concat(this.baseUrl,"/users/me"),{headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}).then((function(e){return t._getResponseData(e)}))}},{key:"setUserInfo",value:function(e){var t=this,n=e.name,a=e.about,c=e.token;return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(c)}),body:JSON.stringify({name:n,about:a})}).then((function(e){return t._getResponseData(e)}))}},{key:"setUserAvatar",value:function(e){var t=this,n=e.avatar,a=e.token;return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(a)}),body:JSON.stringify({avatar:n})}).then((function(e){return t._getResponseData(e)}))}},{key:"addCard",value:function(e){var t=this,n=e.name,a=e.link,c=e.token;return fetch("".concat(this.baseUrl,"/cards"),{headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(c)}),method:"POST",body:JSON.stringify({name:n,link:a})}).then((function(e){return t._getResponseData(e)}))}},{key:"removeCard",value:function(e,t){var n=this;return fetch("".concat(this.baseUrl,"/cards/").concat(e),{headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(t)}),method:"DELETE"}).then((function(e){return n._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t,n){var a=this;return fetch("".concat(this.baseUrl,"/cards/").concat(e,"/likes/"),{headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(n)}),method:t}).then((function(e){return a._getResponseData(e)}))}},{key:"getAppInfo",value:function(e){return Promise.all([this.getInitialCards(e),this.getUserInfo(e)])}}]),e}())({baseUrl:"https://api.mm15.students.nomoreparties.site",headers:{"Content-Type":"application/json"}}),I=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(L.a)(this,e),this.baseUrl=n,this.headers=a}return Object(w.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"registerUser",value:function(e){return fetch("".concat(this.baseUrl,"/signup"),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then(this._getResponseData)}},{key:"signInUser",value:function(e){return fetch("".concat(this.baseUrl,"/signin"),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then(this._getResponseData)}},{key:"validateUser",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{headers:Object(u.a)(Object(u.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}).then(this._getResponseData)}}]),e}())({baseUrl:"https://api.mm15.students.nomoreparties.site",headers:{"Content-Type":"application/json"}});var R=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(!1),r=Object(l.a)(s,2),i=r[0],d=r[1],m=Object(a.useState)(!1),_=Object(l.a)(m,2),f=_[0],N=_[1],P=Object(a.useState)(!1),A=Object(l.a)(P,2),L=A[0],w=A[1],R=Object(a.useState)(!1),T=Object(l.a)(R,2),z=T[0],B=T[1],J=Object(a.useState)(!1),q=Object(l.a)(J,2),F=q[0],H=q[1],M=Object(a.useState)({}),V=Object(l.a)(M,2),Y=V[0],Z=V[1],G=Object(a.useState)({}),K=Object(l.a)(G,2),Q=K[0],W=K[1],X=Object(a.useState)([]),$=Object(l.a)(X,2),ee=$[0],te=$[1],ne=Object(a.useState)(!1),ae=Object(l.a)(ne,2),ce=ae[0],se=ae[1],re=Object(a.useState)(""),ie=Object(l.a)(re,2),oe=ie[0],ue=ie[1],le=Object(a.useState)(""),pe=Object(l.a)(le,2),je=pe[0],de=pe[1],be=Object(p.g)();Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e&&(de(e),he(e))}),[]);var he=function(e){I.validateUser(e).then((function(t){W(t),se(!0),ue(t.email),E.getInitialCards(e).then((function(e){return te(e)})).catch((function(e){return console.log(e)})),be.push("/")})).catch((function(e){return console.log(e)}))},me=function(){B(!0)},Oe=function(){H(!0)},_e=function(){N(!1),c(!1),d(!1),w(!1),Z({}),B(!1),H(!1)};return Object(b.jsxs)(j.Provider,{value:Q,children:[Object(b.jsx)(h,{email:oe,loggedIn:ce,onSignOut:function(){localStorage.removeItem("jwt"),de(""),se(!1),ue(""),be.push("/signin")}}),Object(b.jsxs)(p.d,{children:[Object(b.jsx)(O,{component:v,exact:!0,path:"/",loggedIn:ce,cards:ee,onCardClick:function(e){w(!0),Z(e)},onCardDelete:function(e){E.removeCard(e._id,je).then((function(){var t=ee.filter((function(t){return t._id!==e._id}));te(t)})).catch((function(e){return console.log(e)}))},onCardLike:function(e){var t=e.likes.some((function(e){return e===Q._id}));E.changeLikeCardStatus(e._id,t?"DELETE":"PUT",je).then((function(t){var n=ee.map((function(n){return n._id===e._id?t:n}));te(n)})).catch((function(e){return console.log(e)}))},onEditProfile:function(){c(!0)},onEditAvatar:function(){N(!0)},onAddPlace:function(){d(!0)}}),Object(b.jsx)(p.b,{path:"/signin",children:Object(b.jsx)(y,{onLogin:function(e){I.signInUser(e).then((function(e){var t=e.token;localStorage.setItem("jwt",t),de(t),he(t)})).catch((function(e){Oe(),console.log(e)}))}})}),Object(b.jsx)(p.b,{path:"/signup",children:Object(b.jsx)(U,{onRegister:function(e){I.registerUser(e).then((function(){me(),be.push("/signin")})).catch((function(e){Oe(),console.log(e)}))}})}),Object(b.jsx)(p.b,{children:Object(b.jsx)(p.a,{to:ce?"/":"/signin"})})]}),ce&&Object(b.jsx)(x,{}),Object(b.jsx)(k,{isOpen:n,onClose:_e,onUpdateUser:function(e){var t=e.name,n=e.about;E.setUserInfo({name:t,about:n,token:je}).then((function(e){W(Object(u.a)(Object(u.a)({},Q),{},{name:e.name,about:e.about})),_e()})).catch((function(e){return console.log(e)}))}}),Object(b.jsx)(C,{isOpen:f,onClose:_e,onUpdateAvatar:function(e){var t=e.avatar;E.setUserAvatar({avatar:t,token:je}).then((function(e){W(Object(u.a)(Object(u.a)({},Q),{},{avatar:e.avatar})),_e()})).catch((function(e){return console.log(e)}))}}),Object(b.jsx)(S,{isOpen:i,onClose:_e,onAddPlace:function(e){var t=e.name,n=e.link;E.addCard({name:t,link:n,token:je}).then((function(e){te([].concat(Object(o.a)(ee),[e])),_e()})).catch((function(e){return console.log(e)}))}}),Object(b.jsx)(g,{card:Y,isOpen:L,onClose:_e}),Object(b.jsx)(D,{type:"success",isOpen:z,onClose:_e}),Object(b.jsx)(D,{type:"error",isOpen:F,onClose:_e})]})};r.a.render(Object(b.jsx)(i.a,{children:Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(R,{})})}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.1c43bbc8.chunk.js.map