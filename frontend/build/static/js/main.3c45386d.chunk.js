(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{22:function(e,t,a){e.exports=a.p+"static/media/logo.8f7611ae.svg"},24:function(e,t,a){e.exports=a.p+"static/media/edit_large_icon.d476a8b8.svg"},25:function(e,t,a){e.exports=a.p+"static/media/success_tooltip.e38b395c.svg"},26:function(e,t,a){e.exports=a.p+"static/media/error_tooltip.4072126c.svg"},29:function(e,t,a){e.exports=a(40)},34:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),o=a.n(c),i=a(7),s=(a(34),a(27)),l=a(1),u=a(2),m=a(3),p=r.a.createContext(),d=a(22),h=a.n(d);var _=function(e){var t=e.email,a=e.loggedIn,n=e.onSignOut,c=Object(m.h)();return r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:h.a,alt:"Logo",className:"header__logo"}),a?r.a.createElement("ul",{className:"header__menu-items"},r.a.createElement("li",{className:"header__menu-item header__nav-text_email"},t),r.a.createElement("li",{className:"header__menu-item header__nav-text"},r.a.createElement("button",{className:"header__nav-text header__nav-text_muted",onClick:n},"Log out"))):r.a.createElement(i.b,{className:"header__nav-text",to:"/signin"===c.pathname?"/signup":"/signin"},"/signin"===c.pathname?"Sign up":"Sign in"))},f=a(28);var b=function(e){var t=e.component,a=Object(f.a)(e,["component"]);return r.a.createElement(m.b,null,(function(){return a.loggedIn?r.a.createElement(t,a):r.a.createElement(m.a,{to:"/signin"})}))},v=a(24),g=a.n(v);var E=function(e){var t=e.card,a=e.onCardDelete,n=e.onCardClick,c=e.onCardLike,o=r.a.useContext(p),i=t.name,s=t.link,l=t.likes,u=t.owner,m=o._id===u,d=l.some((function(e){return e===o._id}));return r.a.createElement("li",{className:"card"},r.a.createElement("img",{className:"card__image",alt:"Pic: ".concat(i),src:s,onClick:function(){n(t)}}),r.a.createElement("div",{className:"card__text-container"},r.a.createElement("p",{className:"card__text"},i),r.a.createElement("div",{className:"card__likes-container"},r.a.createElement("button",{className:"button button_like ".concat(d&&"button_like-black"),onClick:function(){c(t)}}),r.a.createElement("p",{className:"card__likes-text"},l.length))),m&&r.a.createElement("button",{className:"button button_delete",onClick:function(){a(t)}}))};var O=function(e){var t=e.cards,a=e.onCardLike,n=e.onCardDelete,c=e.onCardClick,o=e.onEditProfile,i=e.onEditAvatar,s=e.onAddPlace,l=r.a.useContext(p),u=l.name,m=l.about,d=l.avatar;return r.a.createElement("main",null,r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__avatar-container"},r.a.createElement("img",{alt:"Avatar Pic",className:"profile__avatar",src:d}),r.a.createElement("div",{className:"profile__avatar-edit",onClick:i},r.a.createElement("img",{src:g.a,alt:""}))),r.a.createElement("div",{className:"profile__text-container"},r.a.createElement("h1",{className:"profile__name"},u),r.a.createElement("button",{className:"button button_edit",onClick:o}),r.a.createElement("p",{className:"profile__description"},m)),r.a.createElement("button",{className:"button button_add",onClick:s})),r.a.createElement("section",{className:"elements"},r.a.createElement("ul",{className:"cards"},t.map((function(e){return r.a.createElement(E,{card:e,onCardDelete:n,onCardClick:c,onCardLike:a,key:e._id})})))))};var N=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__text"},"\xa9 2020 Around The U.S."))};var j=function(e){var t=e.card,a=e.onClose,n=e.isOpen,c=t.name,o=t.link;return r.a.createElement("div",{className:"popup popup_image ".concat(n&&"popup_is-opened")},r.a.createElement("div",{className:"popup__container"},r.a.createElement("img",{className:"popup__image",alt:c,src:o}),r.a.createElement("h2",{className:"popup__image-title"},c),r.a.createElement("button",{className:"button button_close",onClick:a})))};var k=function(e){var t=e.name,a=e.title,n=e.buttonText,c=e.children,o=e.isOpen,i=e.onClose,s=e.onSubmit;return r.a.createElement("div",{className:"popup popup_type_".concat(t," ").concat(o&&"popup_is-opened")},r.a.createElement("div",{className:"popup__container popup__container_form"},r.a.createElement("form",{className:"popup__form",name:t,onSubmit:s,noValidate:!0},r.a.createElement("h2",{className:"popup__title"},a),c,r.a.createElement("button",{type:"submit",className:"button button_save popup__input"},n)),r.a.createElement("button",{className:"button button_close",onClick:i})))};var C=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,c=r.a.useContext(p),o=r.a.useState(""),i=Object(u.a)(o,2),s=i[0],l=i[1],m=r.a.useState(""),d=Object(u.a)(m,2),h=d[0],_=d[1];return r.a.useEffect((function(){l(c.name),_(c.about)}),[c]),r.a.createElement(k,{name:"edit-profile",title:"Edit Profile",buttonText:"Save",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:s,about:h})},children:r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"popup__field"},r.a.createElement("input",{type:"text",className:"popup__input popup__input_name",placeholder:"Edit Name",minLength:"2",maxLength:"40",pattern:"[A-Za-z -]+",required:!0,id:"name-input",value:s||"",onChange:function(e){return l(e.target.value)}}),r.a.createElement("span",{id:"name-input-error",className:"popup__input-error"})),r.a.createElement("label",{className:"popup__field"},r.a.createElement("input",{type:"text",className:"popup__input popup__input_desc",placeholder:"Edit Job",minLength:"2",maxLength:"200",required:!0,id:"desc-input",value:h||"",onChange:function(e){return _(e.target.value)}}),r.a.createElement("span",{className:"popup__input-error",id:"desc-input-error"})))})};var S=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,c=r.a.useRef();return r.a.createElement(k,{name:"edit-avatar",title:"Change Profile Picture",buttonText:"Save",isOpen:t,onClose:a,children:r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"popup__field"},r.a.createElement("input",{type:"url",className:"popup__input popup__input_avatar",placeholder:"Avatar Link",required:!0,id:"avatar-input",ref:c}),r.a.createElement("span",{id:"avatar-input-error",className:"popup__input-error"}))),onSubmit:function(e){e.preventDefault(),n({avatar:c.current.value})}})};var y=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,c=r.a.useRef(),o=r.a.useRef();return r.a.createElement(k,{name:"new-place",title:"New Place",buttonText:"Save",isOpen:t,onClose:a,children:r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{className:"popup__field"},r.a.createElement("input",{type:"text",className:"popup__input popup__input_name",placeholder:"Title",minLength:"1",maxLength:"30",required:!0,id:"title-input",ref:c}),r.a.createElement("span",{className:"popup__input-error",id:"title-input-error"})),r.a.createElement("label",{className:"popup__field"},r.a.createElement("input",{type:"url",className:"popup__input popup__input_link",placeholder:"Image Link",required:!0,id:"link-input",ref:o}),r.a.createElement("span",{className:"popup__input-error",id:"link-input-error"}))),onSubmit:function(e){e.preventDefault(),n({name:c.current.value,link:o.current.value})}})};var U=function(e){var t=e.onLogin,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)(""),m=Object(u.a)(l,2),p=m[0],d=m[1];return r.a.createElement("div",{className:"form"},r.a.createElement("form",{className:"form__container",onSubmit:function(e){e.preventDefault(),t({email:o,password:p})}},r.a.createElement("h1",{className:"form__title"},"Log in"),r.a.createElement("input",{className:"form__input",type:"email",value:o,onChange:function(e){return s(e.target.value)},placeholder:"Email"}),r.a.createElement("input",{className:"form__input",type:"password",value:p,onChange:function(e){return d(e.target.value)},placeholder:"Password"}),r.a.createElement("button",{type:"submit",className:"form__submit"},"Log in"),r.a.createElement(i.b,{className:"form__link",to:"/signup"},"Not a member yet? Sign up here!")))};var x=function(e){var t=e.onRegister,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)(""),m=Object(u.a)(l,2),p=m[0],d=m[1];return r.a.createElement("div",{className:"form",onSubmit:function(e){e.preventDefault(),t({email:o,password:p})}},r.a.createElement("form",{className:"form__container"},r.a.createElement("h1",{className:"form__title"},"Sign up"),r.a.createElement("input",{className:"form__input",type:"email",value:o,placeholder:"Email",onChange:function(e){return s(e.target.value)}}),r.a.createElement("input",{className:"form__input",type:"password",placeholder:"Password",value:p,onChange:function(e){return d(e.target.value)}}),r.a.createElement("button",{type:"submit",className:"form__submit"},"Sign up"),r.a.createElement(i.b,{className:"form__link",to:"/signin"},"Already a member? Log in here!")))},P=a(25),A=a.n(P),D=a(26),L=a.n(D);var w=function(e){var t,a,n,c=e.isOpen,o=e.onClose;switch(e.type){case"success":t=A.a,a="Pic: success",n="Success! You have now been registered.";break;default:t=L.a,a="Pic: error",n="Oops, something went wrong! Please try again."}return r.a.createElement("div",{className:"popup ".concat(c&&"popup_is-opened")},r.a.createElement("div",{className:"popup__container popup__container_form popup__container_tooltip"},r.a.createElement("img",{src:t,alt:a}),r.a.createElement("p",{className:"popup__text"},n),r.a.createElement("button",{className:"button button_close",onClick:o})))},I=a(13),R=a(14),T=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(I.a)(this,e),this.baseUrl=a,this.headers=n}return Object(R.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getInitialCards",value:function(e){var t=this;return fetch("".concat(this.baseUrl,"/cards"),{headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}).then((function(e){return t._getResponseData(e)}))}},{key:"getUserInfo",value:function(e){var t=this;return fetch("".concat(this.baseUrl,"/users/me"),{headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}).then((function(e){return t._getResponseData(e)}))}},{key:"setUserInfo",value:function(e){var t=this,a=e.name,n=e.about,r=e.token;return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(r)}),body:JSON.stringify({name:a,about:n})}).then((function(e){return t._getResponseData(e)}))}},{key:"setUserAvatar",value:function(e){var t=this,a=e.avatar,n=e.token;return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(n)}),body:JSON.stringify({avatar:a})}).then((function(e){return t._getResponseData(e)}))}},{key:"addCard",value:function(e){var t=this,a=e.name,n=e.link,r=e.token;return fetch("".concat(this.baseUrl,"/cards"),{headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(r)}),method:"POST",body:JSON.stringify({name:a,link:n})}).then((function(e){return t._getResponseData(e)}))}},{key:"removeCard",value:function(e,t){var a=this;return fetch("".concat(this.baseUrl,"/cards/").concat(e),{headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(t)}),method:"DELETE"}).then((function(e){return a._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t,a){var n=this;return fetch("".concat(this.baseUrl,"/cards/").concat(e,"/likes/"),{headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(a)}),method:t}).then((function(e){return n._getResponseData(e)}))}},{key:"getAppInfo",value:function(e){return Promise.all([this.getInitialCards(e),this.getUserInfo(e)])}}]),e}())({baseUrl:"http://api.mm15.students.nomoreparties.site/",headers:{"Content-Type":"application/json"}}),z=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(I.a)(this,e),this.baseUrl=a,this.headers=n}return Object(R.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"registerUser",value:function(e){return fetch("".concat(this.baseUrl,"/signup"),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then(this._getResponseData)}},{key:"signInUser",value:function(e){return fetch("".concat(this.baseUrl,"/signin"),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then(this._getResponseData)}},{key:"validateUser",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{headers:Object(l.a)(Object(l.a)({},this.headers),{},{Authorization:"Bearer ".concat(e)})}).then(this._getResponseData)}}]),e}())({baseUrl:"http://api.mm15.students.nomoreparties.site/",headers:{"Content-Type":"application/json"}});var B=function(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),i=Object(u.a)(o,2),d=i[0],h=i[1],f=Object(n.useState)(!1),v=Object(u.a)(f,2),g=v[0],E=v[1],k=Object(n.useState)(!1),P=Object(u.a)(k,2),A=P[0],D=P[1],L=Object(n.useState)(!1),I=Object(u.a)(L,2),R=I[0],B=I[1],J=Object(n.useState)(!1),q=Object(u.a)(J,2),F=q[0],H=q[1],M=Object(n.useState)({}),V=Object(u.a)(M,2),Y=V[0],Z=V[1],G=Object(n.useState)({}),K=Object(u.a)(G,2),Q=K[0],W=K[1],X=Object(n.useState)([]),$=Object(u.a)(X,2),ee=$[0],te=$[1],ae=Object(n.useState)(!1),ne=Object(u.a)(ae,2),re=ne[0],ce=ne[1],oe=Object(n.useState)(""),ie=Object(u.a)(oe,2),se=ie[0],le=ie[1],ue=Object(n.useState)(""),me=Object(u.a)(ue,2),pe=me[0],de=me[1],he=Object(m.g)();Object(n.useEffect)((function(){var e=localStorage.getItem("jwt");e&&(de(e),_e(e))}),[]);var _e=function(e){z.validateUser(e).then((function(t){W(t),ce(!0),le(t.email),T.getInitialCards(e).then((function(e){return te(e)})).catch((function(e){return console.log(e)})),he.push("/")})).catch((function(e){return console.log(e)}))},fe=function(){B(!0)},be=function(){H(!0)},ve=function(){E(!1),c(!1),h(!1),D(!1),Z({}),B(!1),H(!1)};return r.a.createElement(p.Provider,{value:Q},r.a.createElement(_,{email:se,loggedIn:re,onSignOut:function(){localStorage.removeItem("jwt"),de(""),ce(!1),le(""),he.push("/signin")}}),r.a.createElement(m.d,null,r.a.createElement(b,{component:O,exact:!0,path:"/",loggedIn:re,cards:ee,onCardClick:function(e){D(!0),Z(e)},onCardDelete:function(e){T.removeCard(e._id,pe).then((function(t){var a=ee.filter((function(t){return t._id!==e._id}));te(a)})).catch((function(e){return console.log(e)}))},onCardLike:function(e){var t=e.likes.some((function(e){return e===Q._id}));T.changeLikeCardStatus(e._id,t?"DELETE":"PUT",pe).then((function(t){var a=ee.map((function(a){return a._id===e._id?t:a}));te(a)})).catch((function(e){return console.log(e)}))},onEditProfile:function(){c(!0)},onEditAvatar:function(){E(!0)},onAddPlace:function(){h(!0)}}),r.a.createElement(m.b,{path:"/signin"},r.a.createElement(U,{onLogin:function(e){z.signInUser(e).then((function(e){var t=e.token;localStorage.setItem("jwt",t),de(t),_e(t)})).catch((function(e){be(),console.log(e)}))}})),r.a.createElement(m.b,{path:"/signup"},r.a.createElement(x,{onRegister:function(e){z.registerUser(e).then((function(e){fe(),he.push("/signin")})).catch((function(e){be(),console.log(e)}))}})),r.a.createElement(m.b,null,r.a.createElement(m.a,{to:re?"/":"/signin"}))),re&&r.a.createElement(N,null),r.a.createElement(C,{isOpen:a,onClose:ve,onUpdateUser:function(e){var t=e.name,a=e.about;T.setUserInfo({name:t,about:a,token:pe}).then((function(e){W(Object(l.a)(Object(l.a)({},Q),{},{name:e.name,about:e.about})),ve()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(S,{isOpen:g,onClose:ve,onUpdateAvatar:function(e){var t=e.avatar;T.setUserAvatar({avatar:t,token:pe}).then((function(e){W(Object(l.a)(Object(l.a)({},Q),{},{avatar:e.avatar})),ve()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(y,{isOpen:d,onClose:ve,onAddPlace:function(e){var t=e.name,a=e.link;T.addCard({name:t,link:a,token:pe}).then((function(e){te([].concat(Object(s.a)(ee),[e])),ve()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(j,{card:Y,isOpen:A,onClose:ve}),r.a.createElement(w,{type:"success",isOpen:R,onClose:ve}),r.a.createElement(w,{type:"error",isOpen:F,onClose:ve}))};o.a.render(r.a.createElement(i.a,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null))),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.3c45386d.chunk.js.map