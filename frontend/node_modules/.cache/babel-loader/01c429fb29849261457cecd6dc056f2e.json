{"ast":null,"code":"import _toConsumableArray from\"/Users/Marina/Yandex Practicum/around-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/Marina/Yandex Practicum/around-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/Marina/Yandex Practicum/around-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{BrowserRouter,Switch,Route,Redirect,useHistory}from\"react-router-dom\";import{CurrentUserContext}from\"../contexts/CurrentUserContext\";import Header from\"./Header\";import ProtectedRoute from\"./ProtectedRoute\";import Main from\"./Main\";import Footer from\"./Footer\";import PopupWithImage from\"./PopupWithImage\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import AddPlacePopup from\"./AddPlacePopup\";import Login from\"./Login\";import Register from\"./Register\";import InfoTooltip from\"./InfoTooltip\";import api from\"../utils/api\";import auth from\"../utils/auth\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditProfilePopupOpen=_useState2[0],setIsEditProfilePopupOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAddPlacePopupOpen=_useState4[0],setIsAddPlacePopupOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditAvatarPopupOpen=_useState6[0],setIsEditAvatarPopupOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isImagePopupOpen=_useState8[0],setIsImagePopupOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isSuccessTooltipOpen=_useState10[0],setIsSuccessTooltipOpen=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isErrorTooltipOpen=_useState12[0],setIsErrorTooltipOpen=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),selectedCard=_useState14[0],setSelectedCard=_useState14[1];var _useState15=useState({}),_useState16=_slicedToArray(_useState15,2),currentUser=_useState16[0],setCurrentUser=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),cards=_useState18[0],setCards=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),loggedIn=_useState20[0],setLoggedIn=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),email=_useState22[0],setEmail=_useState22[1];var history=useHistory();// useEffect(() => {\n//   api\n//     .getAppInfo()\n//     .then(([cardListData, userInfoData]) => {\n//       setCurrentUser(userInfoData);\n//       setCards(cardListData);\n//     })\n//     .catch((error) => {\n//       console.log(error);\n//     });\n//   if (localStorage.getItem(\"jwt\")) {\n//     auth\n//       .validateUser()\n//       .then((user) => {\n//         setLoggedIn(true);\n//         setEmail(user.email);\n//         setCurrentUser(user);\n//         history.push(\"/\");\n//       })\n//       .catch((err) => console.log(err));\n//   }\n// }, []);\nvar handleEditAvatarClick=function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);};var handleEditProfileClick=function handleEditProfileClick(){setIsEditProfilePopupOpen(true);};var handleAddPlaceClick=function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);};var openSuccessTooltip=function openSuccessTooltip(){setIsSuccessTooltipOpen(true);};var openErrorTooltip=function openErrorTooltip(){setIsErrorTooltipOpen(true);};var handleUpdateUser=function handleUpdateUser(_ref){var name=_ref.name,description=_ref.description;api.setUserInfo({currentUser:currentUser,name:name,about:description}).then(function(res){setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{name:res.name,about:res.about}));closeAllPopups();}).catch(function(error){console.log(error);});};var handleUpdateAvatar=function handleUpdateAvatar(_ref2){var avatar=_ref2.avatar;api.setUserAvatar({avatar:avatar}).then(function(res){setCurrentUser(_objectSpread(_objectSpread({},currentUser),{},{avatar:res.avatar}));closeAllPopups();}).catch(function(error){console.log(error);});};var handleAddPlaceSubmit=function handleAddPlaceSubmit(_ref3){var name=_ref3.name,link=_ref3.link;api.addCard({name:name,link:link}).then(function(newCard){setCards([].concat(_toConsumableArray(cards),[newCard]));closeAllPopups();}).catch(function(error){console.log(error);});};var handleCardLike=function handleCardLike(card){var isLiked=card.likes.some(function(c){return c._id===currentUser._id;});api.changeLikeCardStatus(card._id,isLiked?\"DELETE\":\"PUT\").then(function(newCard){var newCards=cards.map(function(c){return c._id===card._id?newCard:c;});setCards(newCards);});};var handleCardDelete=function handleCardDelete(card){api.removeCard(card._id).then(function(res){var newCards=cards.filter(function(c){return c._id!==card._id;});setCards(newCards);});};var handleCardClick=function handleCardClick(card){setIsImagePopupOpen(true);setSelectedCard(card);};var closeAllPopups=function closeAllPopups(){setIsEditAvatarPopupOpen(false);setIsEditProfilePopupOpen(false);setIsAddPlacePopupOpen(false);setIsImagePopupOpen(false);setSelectedCard({});setIsSuccessTooltipOpen(false);setIsErrorTooltipOpen(false);};var handleSignOut=function handleSignOut(){};var handleSignIn=function handleSignIn(){};var handleRegister=function handleRegister(data){auth.registerUser(data).then(function(res){if(res){history.push(\"./signin\");openSuccessTooltip();}return Promise.reject();}).catch(function(){openErrorTooltip();console.log(\"400 - one of the fields was filled in incorrectly\");});};return/*#__PURE__*/React.createElement(CurrentUserContext.Provider,{value:currentUser},/*#__PURE__*/React.createElement(BrowserRouter,null,/*#__PURE__*/React.createElement(Header,{email:email,loggedIn:loggedIn,onSignOut:handleSignOut}),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(ProtectedRoute,{component:Main,exact:true,path:\"/\",loggedIn:loggedIn,cards:cards,onCardClick:handleCardClick,onCardDelete:handleCardDelete,onCardLike:handleCardLike,onEditProfile:handleEditProfileClick,onEditAvatar:handleEditAvatarClick,onAddPlace:handleAddPlaceClick}),/*#__PURE__*/React.createElement(Route,{path:\"/signin\"},/*#__PURE__*/React.createElement(Login,{onLogin:handleSignIn})),/*#__PURE__*/React.createElement(Route,{path:\"/signup\"},/*#__PURE__*/React.createElement(Register,{onRegister:handleRegister})),/*#__PURE__*/React.createElement(Route,null,/*#__PURE__*/React.createElement(Redirect,{to:loggedIn?\"/\":\"/signin\"}))),loggedIn&&/*#__PURE__*/React.createElement(Footer,null)),/*#__PURE__*/React.createElement(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/React.createElement(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/React.createElement(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/React.createElement(PopupWithImage,{card:selectedCard,isOpen:isImagePopupOpen,onClose:closeAllPopups}),/*#__PURE__*/React.createElement(InfoTooltip,{type:\"success\",isOpen:isSuccessTooltipOpen,onClose:closeAllPopups}),/*#__PURE__*/React.createElement(InfoTooltip,{type:\"error\",isOpen:isErrorTooltipOpen,onClose:closeAllPopups}));}export default App;","map":{"version":3,"sources":["/Users/Marina/Yandex Practicum/around-react/src/components/App.js"],"names":["React","useState","useEffect","BrowserRouter","Switch","Route","Redirect","useHistory","CurrentUserContext","Header","ProtectedRoute","Main","Footer","PopupWithImage","EditProfilePopup","EditAvatarPopup","AddPlacePopup","Login","Register","InfoTooltip","api","auth","App","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isImagePopupOpen","setIsImagePopupOpen","isSuccessTooltipOpen","setIsSuccessTooltipOpen","isErrorTooltipOpen","setIsErrorTooltipOpen","selectedCard","setSelectedCard","currentUser","setCurrentUser","cards","setCards","loggedIn","setLoggedIn","email","setEmail","history","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","openSuccessTooltip","openErrorTooltip","handleUpdateUser","name","description","setUserInfo","about","then","res","closeAllPopups","catch","error","console","log","handleUpdateAvatar","avatar","setUserAvatar","handleAddPlaceSubmit","link","addCard","newCard","handleCardLike","card","isLiked","likes","some","c","_id","changeLikeCardStatus","newCards","map","handleCardDelete","removeCard","filter","handleCardClick","handleSignOut","handleSignIn","handleRegister","data","registerUser","push","Promise","reject"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  BrowserRouter,\n  Switch,\n  Route,\n  Redirect,\n  useHistory,\n} from \"react-router-dom\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext\";\nimport Header from \"./Header\";\nimport ProtectedRoute from \"./ProtectedRoute\";\nimport Main from \"./Main\";\nimport Footer from \"./Footer\";\nimport PopupWithImage from \"./PopupWithImage\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\nimport Login from \"./Login\";\nimport Register from \"./Register\";\nimport InfoTooltip from \"./InfoTooltip\";\nimport api from \"../utils/api\";\nimport auth from \"../utils/auth\";\n\nfunction App() {\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = useState(false);\n  const [isImagePopupOpen, setIsImagePopupOpen] = useState(false);\n  const [isSuccessTooltipOpen, setIsSuccessTooltipOpen] = useState(false);\n  const [isErrorTooltipOpen, setIsErrorTooltipOpen] = useState(false);\n  const [selectedCard, setSelectedCard] = useState({});\n  const [currentUser, setCurrentUser] = useState({});\n  const [cards, setCards] = useState([]);\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [email, setEmail] = useState(false);\n  const history = useHistory();\n\n  // useEffect(() => {\n  //   api\n  //     .getAppInfo()\n  //     .then(([cardListData, userInfoData]) => {\n  //       setCurrentUser(userInfoData);\n  //       setCards(cardListData);\n  //     })\n  //     .catch((error) => {\n  //       console.log(error);\n  //     });\n  //   if (localStorage.getItem(\"jwt\")) {\n  //     auth\n  //       .validateUser()\n  //       .then((user) => {\n  //         setLoggedIn(true);\n  //         setEmail(user.email);\n  //         setCurrentUser(user);\n  //         history.push(\"/\");\n  //       })\n  //       .catch((err) => console.log(err));\n  //   }\n  // }, []);\n\n  const handleEditAvatarClick = () => {\n    setIsEditAvatarPopupOpen(true);\n  };\n  const handleEditProfileClick = () => {\n    setIsEditProfilePopupOpen(true);\n  };\n  const handleAddPlaceClick = () => {\n    setIsAddPlacePopupOpen(true);\n  };\n  const openSuccessTooltip = () => {\n    setIsSuccessTooltipOpen(true);\n  };\n  const openErrorTooltip = () => {\n    setIsErrorTooltipOpen(true);\n  };\n  const handleUpdateUser = ({ name, description }) => {\n    api\n      .setUserInfo({ currentUser, name: name, about: description })\n      .then((res) => {\n        setCurrentUser({\n          ...currentUser,\n          name: res.name,\n          about: res.about,\n        });\n        closeAllPopups();\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n  const handleUpdateAvatar = ({ avatar }) => {\n    api\n      .setUserAvatar({ avatar })\n      .then((res) => {\n        setCurrentUser({\n          ...currentUser,\n          avatar: res.avatar,\n        });\n        closeAllPopups();\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  const handleAddPlaceSubmit = ({ name, link }) => {\n    api\n      .addCard({ name, link })\n      .then((newCard) => {\n        setCards([...cards, newCard]);\n        closeAllPopups();\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  const handleCardLike = (card) => {\n    const isLiked = card.likes.some((c) => c._id === currentUser._id);\n    api\n      .changeLikeCardStatus(card._id, isLiked ? \"DELETE\" : \"PUT\")\n      .then((newCard) => {\n        const newCards = cards.map((c) => (c._id === card._id ? newCard : c));\n        setCards(newCards);\n      });\n  };\n  const handleCardDelete = (card) => {\n    api.removeCard(card._id).then((res) => {\n      const newCards = cards.filter((c) => c._id !== card._id);\n      setCards(newCards);\n    });\n  };\n  const handleCardClick = (card) => {\n    setIsImagePopupOpen(true);\n    setSelectedCard(card);\n  };\n\n  const closeAllPopups = () => {\n    setIsEditAvatarPopupOpen(false);\n    setIsEditProfilePopupOpen(false);\n    setIsAddPlacePopupOpen(false);\n    setIsImagePopupOpen(false);\n    setSelectedCard({});\n\n    setIsSuccessTooltipOpen(false);\n    setIsErrorTooltipOpen(false);\n  };\n\n  const handleSignOut = () => {};\n  const handleSignIn = () => {};\n  const handleRegister = (data) => {\n    auth\n      .registerUser(data)\n      .then((res) => {\n        if (res) {\n          history.push(\"./signin\");\n          openSuccessTooltip();\n        }\n        return Promise.reject();\n      })\n      .catch(() => {\n        openErrorTooltip();\n        console.log(\"400 - one of the fields was filled in incorrectly\");\n      });\n  };\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <BrowserRouter>\n        <Header email={email} loggedIn={loggedIn} onSignOut={handleSignOut} />\n        <Switch>\n          <ProtectedRoute\n            component={Main}\n            exact\n            path=\"/\"\n            loggedIn={loggedIn}\n            cards={cards}\n            onCardClick={handleCardClick}\n            onCardDelete={handleCardDelete}\n            onCardLike={handleCardLike}\n            onEditProfile={handleEditProfileClick}\n            onEditAvatar={handleEditAvatarClick}\n            onAddPlace={handleAddPlaceClick}\n          />\n          <Route path=\"/signin\">\n            <Login onLogin={handleSignIn} />\n          </Route>\n          <Route path=\"/signup\">\n            <Register onRegister={handleRegister} />\n          </Route>\n          <Route>\n            <Redirect to={loggedIn ? \"/\" : \"/signin\"} />\n          </Route>\n        </Switch>\n        {loggedIn && <Footer />}\n      </BrowserRouter>\n      <EditProfilePopup\n        isOpen={isEditProfilePopupOpen}\n        onClose={closeAllPopups}\n        onUpdateUser={handleUpdateUser}\n      />\n      <EditAvatarPopup\n        isOpen={isEditAvatarPopupOpen}\n        onClose={closeAllPopups}\n        onUpdateAvatar={handleUpdateAvatar}\n      />\n      <AddPlacePopup\n        isOpen={isAddPlacePopupOpen}\n        onClose={closeAllPopups}\n        onAddPlace={handleAddPlaceSubmit}\n      />\n      <PopupWithImage\n        card={selectedCard}\n        isOpen={isImagePopupOpen}\n        onClose={closeAllPopups}\n      />\n      <InfoTooltip\n        type=\"success\"\n        isOpen={isSuccessTooltipOpen}\n        onClose={closeAllPopups}\n      />\n      <InfoTooltip\n        type=\"error\"\n        isOpen={isErrorTooltipOpen}\n        onClose={closeAllPopups}\n      />\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}